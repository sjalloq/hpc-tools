#!/bin/bash
# Generated by hpc-tools (SGE scheduler)

{% for directive in directives %}
{{ directive }}
{% endfor %}

# Exit on error
set -e

# Source module system if available
if [ -f /etc/profile.d/modules.sh ]; then
    . /etc/profile.d/modules.sh
elif [ -f /usr/share/Modules/init/bash ]; then
    . /usr/share/Modules/init/bash
fi

{% if job.modules_path %}
# Additional module paths
{% for path in job.modules_path %}
module use {{ path }}
{% endfor %}
{% endif %}

{% if job.modules %}
# Load modules
{% for mod in job.modules %}
module load {{ mod }}
{% endfor %}
{% endif %}

{% if job.workdir %}
# Change to working directory
cd {{ job.workdir }}
{% endif %}

# Execute command
{{ job.command }}
exit $?
