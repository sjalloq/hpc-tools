#!/bin/bash
# Generated by hpc-runner (local scheduler)
{% set lb = '{' %}

# Exit on error
set -e

{% if job.modules_path %}
# Additional module paths (simulated for local)
{% for path in job.modules_path %}
# module use {{ path }}
{% endfor %}
{% endif %}

{% if job.modules %}
# Modules (simulated for local - not actually loaded)
{% for mod in job.modules %}
# module load {{ mod }}
{% endfor %}
{% endif %}

{% if job.env_prepend %}
# Prepend to environment variables
{% for key, value in job.env_prepend.items() %}
export {{ key }}="{{ value }}${{ lb }}{{ key }}:+:${{ key }}}"
{% endfor %}
{% endif %}

{% if job.env_append %}
# Append to environment variables
{% for key, value in job.env_append.items() %}
export {{ key }}="${{ lb }}{{ key }}:+${{ key }}:}{{ value }}"
{% endfor %}
{% endif %}

{% if job.env_vars %}
# Set custom environment variables
{% for key, value in job.env_vars.items() %}
export {{ key }}="{{ value }}"
{% endfor %}
{% endif %}

{% if job.workdir %}
# Change to working directory
cd {{ job.workdir }}
{% endif %}

# Execute command
{{ job.command }}
exit $?
